<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gigi Quotesüëß - Look Up & Find Quotes!</title>
    <link rel="icon" type="image/png" href="../static/assets/main-icon.png">
    <link rel="stylesheet" href="../static/css/styles.css?v=1.5">
    <link rel="stylesheet" href="../static/css/index.css?v=1.4">
</head>

<body class="loading-locked">
    {% include 'navbar.html' %}
    <main>
        <div class="announcement-banner" id="attentionBanner">
            <div class="banner-content">
                <span class="banner-icon">‚ö†Ô∏è</span>
                <p><strong>Attention:</strong> This website is maintained by one person! Bugs or incorrect speech-to-text
                    translations may occur. Kindly send DMs to my Twitter to report any issues. Thank you for your support!!!
                </p>
                <button class="banner-close" onclick="dismissBanner()">
                    &times;
                </button>
            </div>
        </div>

        <div class="stats-container">
            <a class="stat-link">
                <div class="stat-badge" data-theme="grem">
                    <span class="stat-label">
                        <img src="../static/assets/grem-icon.png" alt="Grem" class="badge-icon">
                        Grems
                    </span>
                    <span class="stat-value" id="grem-count">-</span>
                </div>
            </a>

            <a class="stat-link">
                <div class="stat-badge" data-theme="cece">
                    <span class="stat-label">Cecilia Immergreen</span>
                    <span class="stat-value" id="cece-count">-</span>
                </div>
            </a>

            <a class="stat-link">
                <div class="stat-badge">
                    <span class="stat-label">Yaoi</span>
                    <span class="stat-value" id="yaoi-count">-</span>
                </div>
            </a>

            <a class="stat-link">
                <div class="stat-badge">
                    <span class="stat-label">Yippee</span>
                    <span class="stat-value" id="yippee-count">-</span>
                </div>
            </a>

            <a class="stat-link">
                <div class="stat-badge">
                    <span class="stat-label">6 7</span>
                    <span class="stat-value" id="sixseven-count">-</span>
                </div>
            </a>
        </div>

        <div class="search-guide" id="searchGuide">
            <div class="guide-header" onclick="toggleSearchTips()">
                <h3>üîç Search Tips</h3>
                <svg class="arrow-down-icon" viewBox="0 0 32 32">
                    <path d="M29.994,10.183L15.363,24.812L0.733,10.184c-0.977-0.978-0.977-2.561,0-3.536c0.977-0.977,2.559-0.976,3.536,0
                            l11.095,11.093L26.461,6.647c0.977-0.976,2.559-0.976,3.535,0C30.971,7.624,30.971,9.206,29.994,10.183z" />
                </svg>
            </div>
            <div class="guide-collapsible-content">
                <div class="guide-grid">
                    <div class="guide-item">
                        <strong>Simple Search</strong>
                        <code>Whimsy</code>
                        <span>Finds any titles or quotes containing the word.</span>
                    </div>
                    <div class="guide-item">
                        <strong>Find by ID</strong>
                        <code>15aufXwBIKw</code>
                        <span>Jump directly to a specific video using its VOD ID.</span>
                    </div>
                    <div class="guide-item">
                        <strong>Search Inside a Video</strong>
                        <code>lVi3Wb7WShU; word: yippee</code>
                        <span>Find specific words spoken within that exact video.</span>
                    </div>
                    <div class="guide-item">
                        <strong>Title + Words</strong>
                        <code>title: League of Legends; word: Mori Calliope</code>
                        <span>Search for keywords inside specific videos.</span>
                    </div>
                    <div class="guide-item">
                        <strong>Multiple Keywords</strong>
                        <code>word: yaoi, sandelphon</code>
                        <span>Finds quotes containing BOTH words. Use commas to separate them.</span>
                    </div>
                </div>
                <p class="guide-note">üí° Use a <strong>semicolon (;)</strong> to combine filters. Searches match whole words
                    only.</p>
            </div>
        </div>

        <div class="controls-row">
            <div class="sort-container">
                <a id="sort-newest"
                    href="{{ url_for('index', sort='newest', search=query if query else None, active_tab=active_tab) }}"
                    class="controls-btn {{ 'active' if current_sort == 'newest' }}">
                    Newest
                </a>

                <a id="sort-oldest"
                    href="{{ url_for('index', sort='oldest', search=query if query else None, active_tab=active_tab) }}"
                    class="controls-btn {{ 'active' if current_sort == 'oldest' }}">
                    Oldest
                </a>
            </div>

            <form action="/" method="GET" class="search-form">
                <input type="hidden" name="sort" value="{{ current_sort }}">
                <input type="hidden" name="active_tab" id="activeTabInput" value="{{ active_tab }}">

                <input type="text" name="search" placeholder="Search titles or words..." value="{{ query }}"
                    class="search-input">
                <button type="submit" class="controls-btn" id="search-btn">
                    <img src="../static/assets/search-icon.svg" alt="Search" >
                </button>
                {% if query %}
                <a href="/" class="controls-btn clear-btn"><div id="clear-icon">&times;</div> Clear</a>
                {% endif %}
            </form>

            {% if query %}
            <div class="tabs-header">
                <button class="tab-link {{ 'active' if active_tab == 'Videos' }}" onclick="openTab(event, 'Videos')">
                    Videos ({{ video_results|length }})
                </button>
                <button class="tab-link {{ 'active' if active_tab == 'Quotes' }}" onclick="openTab(event, 'Quotes')">
                    Quotes ({{ total_quotes }})
                </button>
            </div>
            {% endif %}

            {% if request.path == '/random-quotes' %}
            <a href="/random-quotes" class="controls-btn" id="random-quote-btn">Random Quotes Again!</a>
            {% else %}
            <a href="/random-quotes" class="controls-btn" id="random-quote-btn">Random Quotes!</a>
            {% endif %}
        </div>

        <div class="content-area">
            <div id="Videos" class="tab-content {{ 'active' if active_tab == 'Videos' or not active_tab }}"
                style="display: {{ 'block' if active_tab == 'Videos' or not active_tab else 'none' }};">
            
                {% if video_results %}
                    <div id="video-grid" class="grid">
                        {% for video in video_results %}
                        <a href="/video/{{ video.vod_id }}" class="card">
                            <img src="https://img.youtube.com/vi/{{ video.vod_id }}/mqdefault.jpg" alt="Thumbnail">
                            <div class="card-content">
                                <h3>{{ video.title }}</h3>
                                <p class="video-date">{{ video.upload_date }}</p>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                {% elif query %}
                    <div class="no-results-warning">
                        <h2>No exact matches found for "{{ query }}" in videos</h2>
                        <p>Try searching following the searching tips!</p>
                        <a href="/" class="clear-search-link">View all videos</a>
                    </div>
                {% endif %}
            
                {% if video_results %}
                <div id="scroll-sentinel"></div>
                <div id="loading-spinner"></div>
                {% endif %}
            </div>

            {% if query or request.path == '/random-quotes' %}
            <div id="Quotes" class="tab-content {{ 'active' if active_tab == 'Quotes' or request.path == '/random-quotes' }}"
                style="display: {{ 'block' if active_tab == 'Quotes' or request.path == '/random-quotes' else 'none' }};">
            
                {% if quote_results %}
                    <div class="pagination" id="pagination-top"></div>
                    <div class="quote-results-list" id="quotes-container"></div>
                    <div class="pagination" id="pagination-bottom"></div>
                {% else %}
                    <div class="no-results-warning">
                        <h2>No exact matches found for "{{ query }}" in quotes</h2>
                        <p>Try searching following the searching tips!</p>
                        <a href="/" class="clear-search-link">View all videos</a>
                    </div>
                {% endif %}
            </div>
            {% endif %}
        </div>
    </main>

    <script>
        const initialQuotesData = {{ quote_results | tojson | safe if quote_results else '[]' }};
        const totalPages = {{ total_pages | default (1) }};
        const currentPageNum = {{ current_page | default (1) }};
    </script>

    <script src="../static/js/main.js?v=1.1"></script>
    <script src="../static/js/index.js?v=1.2"></script>
</body>

</html>